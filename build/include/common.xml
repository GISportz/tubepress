<?xml version="1.0"?>
<!--
/**
 * Copyright 2006 - 2015 TubePress LLC (http://tubepress.com)
 *
 * This file is part of TubePress (http://tubepress.com)
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 */
-->
<project name="tubepress-build-common">



    <target name="compress-private-js" description="Compresses JS files">

        <echo message="Compressing JS. This may take a moment..." />

        <apply executable="java" parallel="false" dir="${staging-directory}" relative="true">
            <fileset dir="${staging-directory}/" includesfile="${jscompresslist}"/>
            <arg line="-jar"/>
            <arg path="bin/yuicompressor-2.4.8.jar"/>
            <srcfile />
            <arg line="-o" />
            <mapper type="identity" />
            <targetfile />
        </apply>

    </target>

    <target name="compress-private-css" description="Compresses CSS files">

        <echo message="Compressing CSS. This may take a moment..." />

        <apply executable="java" parallel="false" dir="${staging-directory}" relative="true">
            <fileset dir="${staging-directory}/" includesfile="${csscompresslist}"/>
            <arg line="-jar"/>
            <arg path="bin/yuicompressor-2.4.8.jar"/>
            <srcfile />
            <arg line="-o" />
            <mapper type="identity" />
            <targetfile />
        </apply>

    </target>

	<target name="compress-js" description="Compresses JS files">

		<copy verbose="true" todir="${staging-directory}">
			<fileset dir="${staging-directory}/" includesfile="${jscompresslist}"/>
			<mapper type="glob" from="*.js" to="*-dev.js" />
		</copy>

        <antcall target="compress-private-js" />
	</target>

    <target name="compress-css" description="Compresses CSS files">

        <copy verbose="true" todir="${staging-directory}">
            <fileset dir="${staging-directory}/" includesfile="${csscompresslist}"/>
            <mapper type="glob" from="*.css" to="*-dev.css" />
        </copy>

        <antcall target="compress-private-css" />
    </target>

</project>
